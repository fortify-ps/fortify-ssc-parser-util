# Fortify SSC Parser Plugin utility library 

The **fortify-ssc-parser-util** project provides various utility classes 
for implementing custom SSC parser plugins. For now, this is mostly oriented 
at parser plugins that need to parse JSON or XML data, however support for 
other input formats may be added in the future.

The main purpose of this project is to separate the technical aspects of 
parsing JSON or XML data, from the functional logic for handling actual 
JSON or XML contents. As such, this project provides utility classes that 
handle the technical aspects of JSON parsing, such that actual parser plugins 
can focus on the functional logic for handling actual JSON contents.

### Related Links
* **Source code**: https://github.com/fortify-ps/fortify-ssc-parser-util
* **Automated builds**: https://github.com/fortify-ps/fortify-ssc-parser-util/actions
* **Maven Repositories**
  * **Releases**: https://repo1.maven.org/maven2/ 
  * **Snapshots**: https://s01.oss.sonatype.org/content/repositories/snapshots/
* **Sample Projects using fortify-ssc-parser-util**
  * https://github.com/fortify-ps/fortify-ssc-parser-sample
  * https://github.com/fortify-ps/fortify-ssc-parser-sarif
  * https://github.com/fortify-ps/fortify-ssc-parser-owasp-dependency-check
  * https://github.com/fortify-ps/fortify-ssc-parser-clair-yair
  * https://github.com/fortify-ps/fortify-ssc-parser-clair-rest
  * https://github.com/fortify-ps/fortify-ssc-parser-symfony-security-checker
  * https://github.com/fortify-ps/fortify-ssc-parser-php-security-checker
  * https://github.com/fortify-ps/fortify-ssc-parser-tenable-io-cs
  * https://github.com/fortify-ps/fortify-ssc-parser-burp
  
## Usage

### API
Please refer to the JavaDoc and sample projects listed in the [Related Links](#related-links) section
for details on how to use this utility library.

### Build System
The Maven artifacts for this project are automatically deployed to
the Maven repositories listed in the [Related Links](#related-links) section.

Following is an example on how to add this library to your build.gradle script:

```groovy
dependencies {
   // For parsing JSON data
   implementationExport(group: 'com.fortify.ssc.parser.util', name: 'fortify-ssc-parser-util-json', version:'<version>') { transitive = true }
   // For parsing XML data
   implementationExport(group: 'com.fortify.ssc.parser.util', name: 'fortify-ssc-parser-util-xml', version:'<version>') { transitive = true }
}
```

Note that `implementationExport` and other parser-related Gradle functionality is 
defined in a separate Gradle helper script; you can either copy the relevant contents in 
your own build script, or reference an appropriate version of the build script, for example 
using a statement like the following in your build.gradle:

```groovy
apply from: "https://raw.githubusercontent.com/fortify-ps/gradle-helpers/1.5/ssc-parser-plugin-helper.gradle"
```

The configuration listed above will only allow access to release versions of this library.
Usually it is not recommended to depend on snapshot versions of this library, but if necessary
you can use the example below to access snapshot versions of this library. Note the additional
repository definition, and the `changing: true` property on `implementationExport`.

```groovy
repositories {
   maven { url "https://s01.oss.sonatype.org/content/repositories/snapshots/" }
}

dependencies {
   implementationExport(group: 'com.fortify.ssc.parser.util', name: 'fortify-ssc-parser-util', version:'<version>', changing: true) { transitive = true }
}
```



## Information for library developers

The following sections provide information that may be useful for developers of the 
`fortify-ssc-parser-util` library.

### Conventional commits & versioning

Versioning is handled automatically by [`release-please-action`](https://github.com/google-github-actions/release-please-action) based on [Conventional Commits](https://www.conventionalcommits.org/). Every commit to the `main`
branch should follow the Conventional Commits convention, for example:

* `fix: Some fix (#2)`
* `feat: New feature (#3)`
* `api: Some API change`
* `api!: Some breaking API change`

`release-please-action` invoked from the GitHub CI workflow generates pull requests containing updated `CHANGELOG.md` and `version.txt` files based on these commit messages. Merging the pull request will
result in a new release version being published.

The `build.gradle` script reads the version number of the last published release from `version.txt`,
by default this will result in a version named `x.y.z.SP-SNAPSHOT`, indicating that this is a snapshot
of an upcoming Service Pack release. Note the 'Service Pack' here just means 'the next version after the last
published release'. We never actually release service packs; once the 'Service Pack' is ready for release, 
a new version number will be generated by `release-please-action` based on the Conventional Commit
messages.

This default behavior can be modified by passing the `-PisReleaseVersion` property, in which case the `build.gradle` will generate a version named `x.y.z.RELEASE`. This should fit nicely with [Gradle semantics](https://docs.gradle.org/current/userguide/single_versions.html), which states that for example `1.0-RELEASE < 1.0-SP1`.

### Commonly used commands

All commands listed below use Linux/bash notation; adjust accordingly if you
are running on a different platform. All commands are to be executed from
the main project directory.

It is strongly recommended to build this project using the included Gradle Wrapper
scripts; using other Gradle versions may result in build errors and other issues.

* `./gradlew tasks --all`: List all available tasks
* Build & publish:
  * `./gradlew clean build`: Clean and build the project
  * `./gradlew build`: Build the project without cleaning
  * `./gradlew publish`: Publish this build as a snapshot version to the local Maven repository
  * `./gradlew publishToOSSRH`: Publish this build as a snapshot version to OSSRH; usually only done from a GitHub Actions workflow
  * `./gradlew publishToOSSRH closeOSSRHStagingRepository -PisReleaseVersion=true`: Publish this build as a release version to the OSSRH staging area; use this for first-time publishing to check release contents
  * `./gradlew publishToOSSRH closeAndReleaseOSSRHStagingRepository -PisReleaseVersion=true`: Publish this build as a release version to Maven Central; usually only done from a GitHub Actions workflow
  
All OSSRH-related tasks require the following Gradle properties to be set:

* `signingKey`: GPG secret key used to sign the artifacts
* `signingPassword`: Password for the GPG secret key
* `OSSRHUsername`: Sonatype OSSRH user name
* `OSSRHPassword`: Sonatype OSSRH password

These properties can be set on the command line, in a local `gradle.properties` file, or through environment variables named `ORG_GRADLE_PROJECT_<propertyName>`. For automated build pipelines, it is recommended to use a Sonatype OSSRH token rather than actual username and password.


### Automated Builds & publishing

A GitHub Actions `ci.yml` workflow is used to automatically build and publish both snapshot versions and release versions to OSSRH/Maven Central.

See the [Related Links](#related-links) section for the relevant links.


# Licensing
See [LICENSE.TXT](LICENSE.TXT)